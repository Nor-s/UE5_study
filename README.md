# **CH10 아이템 상자와 무기 제작**

- 소켓 시스템
- 플레이어 캐릭터 감지 액터

## **캐릭 소켓 설정**

- 무기는 메시에 착용해야 애니메이션에 따라 무기가 움직임
- 이를 위해 UE에서는 소켓이라는 시스템을 제공


## **무기 액터 제작**

- 필요에 따라 무기 변경
- 새로운 C++ 클래스 > Actor > ABWeapon
- 캐릭터 무기 생성 코드 => BeginPlay에서 무기 액터 생성 및 부착
    - SpawnActor 로 월드에 새로운 액터 생성


## **아이템 상자의 제작**

- 새로운 C++ 클래스 > Actor > ABItemBox
- 콜리전 박스 + 스태틱 메시

> 메시 원본 데이터 스케일 변경 == 스태틱메시 에디터 > 디테일 > LOD0 섹션 > build scale 옵션 설정 (플리커링 오류 이유??)


- 메시의 크기를 참고해 액터에 박스 콜리전 컴포넌트의 크기와 애셋을 지정
    - 박스 콜리전 컴포넌트의 Extend값 == 전체 박스 영역 크기의 절반 값을 의미

- 콜리전 오브젝트 채널 추가 (프로젝트 설정 > 콜리전 )
  - 프리셋 설정: 기본 무시, 캐릭과 오버랩 

- OnComponentBeginOverlap 딜리게이트 사용하여 오버랩 이벤트 처리
  - 매크로를 확인해보면 이것은 멀티캐스트 다이내믹 델리게이트를 사용하여 선언됨
  - 매크로의 타입과 인자를 모두 복사해 동일한 멤버 변수를 선언하고 이를 해당 델리게이트에 바인딩하면 Overlap 이벤트가 발생할 때마다 바인딩한 멤버함수가 호출됨

## **아이템 상자 이펙트**

- OnSystemFinished 델리케이트 : 파티클 컴포넌트 시스템에서 제공
  - 다이내믹 형식, 바인딩할 대상 멤버 함수에 UFUNCTION 매크로 필요(람다 사용불가)


- 시각적인 기능 끄기
  - SetVisibility: 시각적인 기능을 아예 없애는 함수
  - SetHiddenInGame: 에디터 레벨 작업을 할 때는 보여주지만 게임 플레이 중에는 사라짐


## **다른 무기**

- 블루프린트를 사용하여 ABWeapon을 상속받은 객체를 다수 생성
- 블루프린트 클래스 추가 > ABWeapon을 상속받은 클래스 생성
- InstanceOnly 프로퍼티인 WeaponItemClass를 변경하여 특정 무기를 장착시킬 수 있음